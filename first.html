<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certificate Generator Prototype</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fabric.js/5.3.1/fabric.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #f0f2f5; display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .controls { margin-bottom: 20px; background: white; padding: 15px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        button { padding: 10px 15px; margin: 0 5px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 4px; }
        button:hover { background: #0056b3; }
        button.secondary { background: #6c757d; }
        button.secondary:hover { background: #545b62; }
        #canvas-container { border: 1px solid #ccc; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        input[type="file"] { margin-right: 15px; }
    </style>
</head>
<body>

    <h2>1. Upload Certificate Template</h2>
    
    <div class="controls">
        <input type="file" id="imgLoader" accept="image/*">
        
        <span>Add Fields: </span>
        <button onclick="addText('{Name}')">+ Name</button>
        <button onclick="addText('{Event Name}')">+ Event</button>
        <button onclick="addText('{Date}')">+ Date</button>
        
        <button class="secondary" onclick="downloadImage()">Download Preview</button>
    </div>

    <div id="canvas-container">
        <canvas id="c" width="800" height="600"></canvas>
    </div>

    <script>
        // 1. Initialize the Fabric Canvas
        const canvas = new fabric.Canvas('c');

        // 2. Handle Image Upload
        document.getElementById('imgLoader').addEventListener('change', function(e) {
            const reader = new FileReader();
            reader.onload = function(event) {
                const imgObj = new Image();
                imgObj.src = event.target.result;
                imgObj.onload = function() {
                    const imgInstance = new fabric.Image(imgObj);
                    
                    // Resize canvas to match the image size
                    canvas.setWidth(imgInstance.width);
                    canvas.setHeight(imgInstance.height);
                    
                    // Set image as background
                    canvas.setBackgroundImage(imgInstance, canvas.renderAll.bind(canvas));
                }
            }
            reader.readAsDataURL(e.target.files[0]);
        });

        // 3. Function to Add Draggable Text
        function addText(textString) {
            const text = new fabric.Text(textString, {
                left: 100, // Initial X position
                top: 100,  // Initial Y position
                fontFamily: 'Arial',
                fontSize: 40,
                fill: '#000000',
                selectable: true // This enables dragging
            });
            canvas.add(text);
            canvas.setActiveObject(text); // Select it immediately
        }

        // 4. Handle Deletion (Select text and press Delete/Backspace)
        window.addEventListener('keydown', function(e) {
            if(e.key === "Delete" || e.key === "Backspace") {
                const activeObjects = canvas.getActiveObjects();
                if (activeObjects.length) {
                    canvas.discardActiveObject();
                    activeObjects.forEach(function(obj) {
                        canvas.remove(obj);
                    });
                }
            }
        });

        // 5. Download the Result
        function downloadImage() {
            // Convert canvas to image data URL
            const dataURL = canvas.toDataURL({
                format: 'png',
                quality: 1
            });
            
            // Create a fake link to trigger download
            const link = document.createElement('a');
            link.download = 'certificate-preview.png';
            link.href = dataURL;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html> -->